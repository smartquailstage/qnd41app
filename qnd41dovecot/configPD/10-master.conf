# /etc/dovecot/conf.d/10-master.conf

# The "service" configuration block defines different services that Dovecot can run
# Each service can have its own configuration settings, like ports, user, and permissions.

# Default service settings
service auth {
  # Auth service is responsible for authenticating users
  # It should run with minimal privileges
  user = dovecot
  # Disable root privileges for security
  group = dovecot
  # If using SSL, the service should listen on port 0
  inet_listener auth {
    port = 0
  }
}

service imap {
  # IMAP service listens on the standard IMAP port (143) or IMAPS port (993) if SSL is enabled
  inet_listener imap {
    # Listen on port 143 for non-SSL connections
    port = 0
  }
  
  inet_listener imaps {
    # Listen on port 993 for SSL/TLS connections
    port = 993
    # Enable SSL/TLS for this listener
    ssl = yes
  }

  # If using a private socket for local communication
  unix_listener imap {
    # This allows communication via a Unix socket
    # Typically used for local communication
    path = /var/spool/postfix/private/dovecot-imap
    mode = 0660
    user = postfix
    group = postfix
  }
}

service pop3 {
  # POP3 service listens on the standard POP3 port (110) or POP3S port (995) if SSL is enabled
  inet_listener pop3 {
    # Listen on port 110 for non-SSL connections
    port = 0
  }

  inet_listener pop3s {
    # Listen on port 995 for SSL/TLS connections
    port = 995
    # Enable SSL/TLS for this listener
    ssl = yes
  }

  # If using a private socket for local communication
  unix_listener pop3 {
    # This allows communication via a Unix socket
    path = /var/spool/postfix/private/dovecot-pop3
    mode = 0660
    user = postfix
    group = postfix
  }
}

# If using the submission service for sending mail
service submission {
  inet_listener submission {
    # This service is typically used for SMTP submission (port 587)
    port = 587
    # Enable SSL/TLS for this listener
    ssl = yes
  }
}

# To support local delivery
service auth-worker {
  # The auth-worker service handles authentication-related tasks
  user = dovecot
  group = dovecot
}

# You can configure additional services or adjust settings as needed
