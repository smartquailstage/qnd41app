(()=>{"use strict";var t={13:(t,e,n)=>{n.r(e)},557:function(t,e){var n,r=this&&this.__extends||(n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},n(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),o=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(o,a){function i(t){try{u(r.next(t))}catch(t){a(t)}}function s(t){try{u(r.throw(t))}catch(t){a(t)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(i,s)}u((r=r.apply(t,e||[])).next())}))},a=this&&this.__generator||function(t,e){var n,r,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(u){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!((o=(o=i.trys).length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=e.call(t,i)}catch(t){s=[6,t],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,u])}}};e.__esModule=!0,e.fetchResponse=e.getAIConfiguration=void 0;var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e}(Error);e.getAIConfiguration=function(){var t=document.querySelector("#wagtail-ai-config");if(!t||!t.textContent)throw new Error("No wagtail-ai configuration found.");try{return JSON.parse(t.textContent)}catch(t){throw new SyntaxError("Error parsing wagtail-ai configuration: ".concat(t.message))}},e.fetchResponse=function(t,n,r){return o(void 0,void 0,void 0,(function(){var o,s,u,l;return a(this,(function(a){switch(a.label){case 0:return a.trys.push([0,3,,4]),o=(0,e.getAIConfiguration)().urls,[4,fetch(o[t],{method:"POST",body:n,signal:r})];case 1:return[4,(s=a.sent()).json()];case 2:if(u=a.sent(),s.ok)return[2,u.message];throw new i(u.error);case 3:throw l=a.sent(),new i(l.message);case 4:return[2]}}))}))}},847:function(t,e,n){var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(o,a){function i(t){try{u(r.next(t))}catch(t){a(t)}}function s(t){try{u(r.throw(t))}catch(t){a(t)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(i,s)}u((r=r.apply(t,e||[])).next())}))},o=this&&this.__generator||function(t,e){var n,r,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(u){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!((o=(o=i.trys).length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=e.call(t,i)}catch(t){s=[6,t],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,u])}}},a=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};e.__esModule=!0,n(13);var i=n(557),s=a(n(476));document.addEventListener("wagtail-ai:image-form",(function(t){var e=t.target,n=e.dataset.wagtailaiImageId;if(!n)throw new Error("The attribute data-wagtailai-image-id is missing.");if(!e.form)throw new Error("The input is not part of a form.");var a=e.form.querySelector("input[name=csrfmiddlewaretoken]");if(!a)throw new Error("Could not find a CSRF token hidden input.");var u=e.parentNode,l=document.createElement("div");l.classList.add("wagtailai-input-wrapper"),u.replaceChild(l,e),l.appendChild(e);var c=document.createElement("button");c.type="button",c.title=e.dataset.wagtailaiButtonTitle||"",c.classList.add("button","wagtailai-button"),c.innerHTML=s.default,l.appendChild(c);var f=e.getAttribute("maxlength"),d=null;c.addEventListener("click",(function(){return r(void 0,void 0,void 0,(function(){var t,r,s;return o(this,(function(o){switch(o.label){case 0:null===(s=null==d?void 0:d.parentNode)||void 0===s||s.removeChild(d),c.disabled=!0,c.classList.add("loading"),o.label=1;case 1:return o.trys.push([1,3,,4]),(t=new FormData).append("image_id",n),t.append("csrfmiddlewaretoken",a.value),f&&t.append("maxlength",f),r=e,[4,(0,i.fetchResponse)("DESCRIBE_IMAGE",t)];case 2:return r.value=o.sent(),[3,4];case 3:return o.sent(),(d=document.createElement("p")).classList.add("error-message"),d.textContent="Could not generate image description.",u.append(d),[3,4];case 4:return c.classList.remove("loading"),c.disabled=!1,[2]}}))}))}))}))},476:t=>{t.exports='\x3c!-- Based on: Font Awesome Pro 6.3.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2023 Fonticons, Inc. --\x3e\n<svg width="16" height="16" classname="" aria-hidden="true" viewBox="0 0 576 512" fill="none" xmlns="http://www.w3.org/2000/svg">\n    <path id="wand" d="M46.1 395.4C27.4 414.1 27.4 444.5 46.1 463.3L80.7 497.9C99.4 516.6 129.8 516.6 148.6 497.9L529.9 116.5C548.6 97.8 548.6 67.4 529.9 48.6L495.3 14.1C476.6 -4.59999 446.2 -4.59999 427.4 14.1L46.1 395.4ZM484.6 82.6L379.6 187.6L356.3 164.3L461.3 59.3L484.6 82.6Z"/>\n    <path id="star1" d="M352 384C352 379.2 355 374.9 359.5 373.2L416 352L437.2 295.5C438.9 291 443.2 288 448 288C452.8 288 457.1 291 458.8 295.5L480 352L536.5 373.2C541 374.9 544 379.2 544 384C544 388.8 541 393.1 536.5 394.8L480 416L458.8 472.5C457.1 477 452.8 480 448 480C443.2 480 438.9 477 437.2 472.5L416 416L359.5 394.8C355 393.1 352 388.8 352 384Z"/>\n    <path id="star2" d="M197 56.8L234.7 42.7L248.8 5C249.9 2 252.8 0 256 0C259.2 0 262.1 2 263.2 5L277.3 42.7L315 56.8C318 57.9 320 60.8 320 64C320 67.2 318 70.1 315 71.2L277.3 85.3L263.2 123C262.1 126 259.2 128 256 128C252.8 128 249.9 126 248.8 123L234.7 85.3L197 71.2C194 70.1 192 67.2 192 64C192 60.8 194 57.9 197 56.8Z"/>\n    <path id="star3" d="M0 128C0 123.2 3 118.9 7.5 117.2L64 96L85.2 39.5C86.9 35 91.2 32 96 32C100.8 32 105.1 35 106.8 39.5L128 96L184.5 117.2C189 118.9 192 123.2 192 128C192 132.8 189 137.1 184.5 138.8L128 160L106.8 216.5C105.1 221 100.8 224 96 224C91.2 224 86.9 221 85.2 216.5L64 160L7.5 138.8C3 137.1 0 132.8 0 128Z"/>\n</svg>\n'}},e={};function n(r){var o=e[r];if(void 0!==o)return o.exports;var a=e[r]={exports:{}};return t[r].call(a.exports,a,a.exports,n),a.exports}n.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n(847)})();